# 文件操作

### 文件及目录

- 相关命令

  | 命令    | 说明                |
  | ----- | ----------------- |
  | touch | 创建新文件(可以一次创建多个文件) |
  | rm    | 删除文件或目录(加上-r选项)   |
  | mv    | 移动文件或目录           |
  | cp    | 拷贝文件或目录(加上-r选项)   |
  | mkdir | 创建目录(可以一次创建多个)    |
  | rmdir | 删除目录，只能删除空目录      |

- 选项说明

  - -f：表示强制操作，不再提示
  - -r：表示递归操作，经常与-f结合使用
  - *：表示模糊匹配，如：rm -f *.txt，删除所有的txt文件
  - -p：在创建目录时，中间目录不存在，加上此参数可以顺便创建中间目录

### 查看文件

- 相关查看

  | 命令   | 说明                                     |
  | ---- | -------------------------------------- |
  | cat  | 从上到下，将文件内容全部展示出来                       |
  | tac  | 从下到上，将文件内容全部展示出来                       |
  | head | 显示开头的几行内容，默认10行，可以指定行数，如：head -3 1.txt |
  | tail | 显示末尾的几行内容，用法同head                      |
  | nl   | 功能同cat，另外还显示行号                         |
  | wc   | 统计显示，内容：行数 \| 单词数 \| 字符数 \| 文件名        |
  | more | 一点一点查看内容                               |
  | less | 一点一点查看内容                               |

- more和less使用说明

  - 内容显示一屏就会停止
  - q可以退出查看
  - enter向下翻一行
  - 空格向下翻一页
  - 查看结束时more会自动退出，less不会
  - 上下按钮可以控制less上下查看内容，more不可以
  - more和less经常结合管道使用，如：`ls /etc | more`

### 用户和用户组

- 相关命令

  | 命令         | 说明                                       |
  | ---------- | ---------------------------------------- |
  | whoami     | 查看当前登录的用户名                               |
  | useradd    | 新建用户，会在/home创建一个同名的目录                    |
  | userdel    | 删除用户，'-r'可以删除该用户相关的目录                    |
  | su - [用户名] | 切换用户，'-'一定要带，否则只切换用户身份，不切换执行环境，不指定用户名，默认切换到root用户 |
  | sudo       | 已指定的用户身份(root)执行命令，如：sudo service iptables stop |
  | visudo     | 编辑sudo执行列表(/etc/sudoers)，如：xuefei  ALL=(ALL)   ALL |
  | passwd     | 设置指定用户的密码，不指定时设置当前用户的密码                  |
  | groupadd   | 创建用户组                                    |
  | groupdel   | 删除用户组，若组中有用户则无法删除                        |
  | gpasswd    | 向指定的用户组添加/删除指定用户，gpasswd -a/-d 用户 用户组    |
  | chsh       | 修改用户的shell命令解析器，如：chsh xuefei -s /sbin/nologin |
  | chown      | 修改文件所属用户[及用户组]，如：chown xuefei[:xuefei] 1.txt |
  | chgrp      | 修改文件所属组，如：chgrp xuefei 1.txt             |

- 特殊文件

  - /etc/passwd，存放系统中的所有用户信息，一行一个，每一行内容：

    `用户名 : 密码 : 用户ID : 组ID : 描述 ：用户家目录 : 默认shell `

  - /etc/shadow，存放系统中的用户密码

  - /etc/group，存放系统中所有的用户组信息

- 使用说明

  - 用户以及用户组的ID通常要大于等于500，因为小于500的已经被系统占用
  - 创建用户时说明
    - 可以指定ID：useradd xiaogang -u 666
    - 指定家目录：useradd xiaowang -d /xxx/yyy
    - 禁止登陆：useradd meng -s /sbin/nologin
  - 递归更改目录中内容，需要添加选项'-R'
  - 在使用用户名以及组名的地方通过都可以使用UID和GID代替
  - 用户身份标识：'#'表示超级用户；'$'表示普通用户

### 文件权限

- 说明：在linux中文件权限涉及到：所有者、所属组、其它的概念

- 权限：所有的文件都涉及权限，可读(r)、可写(w)、可执行(x)，'-'表示没有对应的权限

- 原理：ls -l的结果集中，权限分为三组，刚好对应：所有者、所属组、其它

- 修改权限：chmod，格式：`chmod [身份] [操作] [权限] 文件`

  | 选项   | 说明         |
  | ---- | ---------- |
  | 身份   |            |
  | u    | 拥有者(user)  |
  | g    | 所属组(group) |
  | o    | 其它(other)  |
  | a    | 所有(all)    |
  | 操作   |            |
  | +    | 添加权限       |
  | -    | 去掉权限       |
  | =    | 设置权限       |
  | 权限   |            |
  | r    | 读          |
  | w    | 写          |
  | x    | 执行         |

  > 如：chmod a+w 1.txt 给所有的身份添加写的权限

- 本质：使用一组(3位)八进制的数据来表示权限，如：0755，解析如下：

  ```
  转换为二进制：0755 => 111 101 101
  对应三个身份：		所有者 所属组 其它
  每一组的权限：都包括可读、可写、可执行
  权限描述：所有者可读可写可执行，所属组可读可执行，其它可读可执行
  ```

- 简化：chmod 0755 1.txt

  > 说明：递归修改目录权限，需要添加选项'-R'

- umask

  - 作用：限定新建文件的默认权限，权限与该值相反

  - 命令：umask [value]，查看或设置掩码

  - 实例分析 0022

    ```
    掩码：0022 => 000 010 010
    新建目录的权限：111 101 101
    新建文件的权限：110 100 100	 # 因为普通文件没有必要有可执行的权限
    ```

  - 配置：默认的修改重启或关闭终端后失效，配置文件在/etc/profile

### 链接文件

- 命令：ln

- 作用：创建一个文件或目录的链接

- 格式：`ln [-s] 原文件 新文件`

- 说明：ls -l命令的结果中的第一列，为'l'的文件就是链接文件

- 软硬链接对比

  ```
  硬链接：创建链接时不加-s选项，相当于一个文件有好几个名字，极少用到
  	1.链接文件与原文件的用户及用户组信息一样
  	2.不能给目录文件添加
  	3.不能跨文件系统
  软链接：创建链接时添加-s选项，相当于windows中的快捷方式，比较常用
  	1.链接文件与原文件的用户及用户组信息一样
  	2.能够给目录添加
  	3.能够跨文件系统
  ```

### 文件搜索

- find

  - 作用：功能非常强大的文件查找命令，可以搜索任意文件

  - 格式：`find [目录] 条件选项`

  - 选项：

    ```
    -name：指定文件名		# find / -name passwd
    -type：指定类型(d/l/s/p/c/b)
    -size：指定大小，单位：k/m/g，+表示大于，-表示小于，如：find -size +5k
    -mtime/atime/ctime：指定修改/访问/创建时间，
    		单位为天，+表示几天前，-表示几天内
    -mmin/amin/cmin：指定修改/访问/创建时间，单位为分钟，用法同上
    -user：指定用户
    -group：指定用户组
    -maxdepth：指定递归搜索的层级深度，默认查找所有
    ```

    ​